# SmartHomeManager -- Automated Residential Systems Controller 2.0

## Description
This project aims to build a centralized, intelligent, and adaptable home automation platform. SmartHomeManager provides control and automation to various aspects of your house including heating/ cooling, lightning system (including smartbul bs and color), window shades control (automatic open close), as security systems integration, as monitoring of the enviro ment (temp/ humidity).

It allows seamless integration via a REST API, a modern UI (React frontend), and a powerful Python backend for core logic. Our core philosophy has to ensure privacy and flexibility.  All sensor data stays within local, user defined, storage. 

We' have created modular components and extensible API allowing custom devices integration and custom routines (e.g automation rules for lighting or temperature depending by time and user event presence).

This is designed for advanced home users and hobbyists. We provide comprehensive documentation, examples and community driven development, making your SmartHome automation simple, customizable and safe to manage.

Finally we provide a system of alerts in events (e.g motion detetct on a door or window, smoke/ fire alerts, temp anomalies) which are customizable to send to different devices like SMS (via SMS gateways) or to a local email server or cloud based service.

## Installation Instructions
Before starting, make sure you satisfy the pre- requisits. You must have installed the last Python (3.1 or later). You need also a Node.js with an npm version >=14 and pip. It is recommended that Python virtual environment are used during installation process to avoid version conf licting.

First, clone the repository into the directory where you want it deployed (usually `/ home / your user / smart-home- manager/ `) using the command. It must be a valid git repo to perform such operation. 

```bash
git clone https://github.com/your-username/smart-home- manager.git
cd smart-home-manager
```

Navigate inside the new directory and create Python Virtual Environment

  ```bash
python env -d smart-home-manager
```
Activate that environment:
  ```bash
source smart- home-manager
 ```

Install the necessary dependencies by using the following: This step will install all necessary dependencies to run the program
  
``` bash
pip install - r requirements.txt
```

For database support, ensure that you install the relevant database connector (e. g. if it is using postgresql, install `psycopg 2`).

To build the frontend (React UI) you need to run the command below. It can fail if there is missing tools in your development setup:
```bash
npm install
npm build
```

If your platform supports docker, this is also another recommended install mode. You'll find `Dockerfile` with the necessary steps to deploy on your platform:
```bash
docker build -t smart-home-manager .
docker run -d -p 8000:8000 smart-home-manager
```

Finally to enable certain advanced components or plugins you'll have to ensure you installed additional tools as described later (i.e., if your security components need specific SMS API integrations or specific device hardware libraries, make sure these components are setup first and available.
The last important note is that on Windows systems use command `pip3` and/ or adjust paths in configuration based by installed tool locations

A post- installation configuration will also take place on first boot (as detailed on the configuration guide section) and will involve database and authentication setup (e.g admin username password setup).

Ensure proper permission of user by using the chown function (or equivalent) to allow to view or execute scripts
Ensure your Python Virtual Enviroment is enabled when performing operations and commands to install dependencies (otherwise pip can fail and install packages on a different system level).

Check all packages installed are correct version using  requirements.txt. It's possible version mismatches occur during a complex dependencies resolution so ensure that it has run with the right version.

Finally verify connectivity from frontend (if running it directly and independently, otherwise check network settings if docker has issues.


## Usage Instructions
After a correct installation the system should expose REST endpoint via URL.

First test if it is accessible:
```bash
curl http::// localhost: 8000/healthcheck
```
Expected Output `status OK`. 

Access web-based dashboard through http:://localhost:3000. Login using the created account credentials or admin if none. From that page it possible configure different settings for your SmartHome devices by setting them, configuring routines etc.
Example, to control lightning: you have a REST call

`GET/ PUT   http:://localhost:8000/devices/lightbulb1 {  on:true   / off:false    intensity: 0 - 100 }`. You should be also possible trigger preconfigured automations and customizing scheduled events, or setting triggers for sensor readings, for security systems integration for instance to activate the security cameras and alarms upon detection by external sources..
If configured for remote connections it would require proper firewall setup with specific inbound ports opened on 8000/3000 (or customized). You might consider enabling SSL /HTTPS and proper security configurations on the external firewall/ router to avoid unencrypted communication or malicious attacks and vulnerabilities

We offer also CLI tool with specific options such: setting temperature or configuring alarms or checking logs from the devices. 
CLI Tool commands include  --check devices ,  --control lighting <deviceID > on  or <value between off/ on / brightness percentage, for a specific light> or -trigger event  . These CLI options allow managing system and automation features etc. and are accessible using `python smarthome.py help`. It's recommended that you explore them for automation or system checks. 
We are adding integration for specific IoT hardware APIs.

If it's not working try checking system logging or using debugger tool, by executing it and running the debugging tool (available in /logs).


## Configuration
SmartHomeManager is configuration based to allow different environment customization, or hardware integrations, and authentication mechanisms and other features to allow for custom configuration options
A `config.yaml` files contains all core system configuration settings (such database URL and API endpoints ).  The system supports setting up these settings via command lines or via configuration UI after a boot up of initial configuration wizard (if first run or reset) to configure it
The database URL must be correct (PostgreSQL ,  SQLite) with appropriate JDBC or connection strings, or database URL

Environmental variables can set the `PORT` environment variables on which SmartHomeManager run or enable different API endpoints for specific services

Example of configuring external integrations via configuration files (API integrations and device protocols for specific manufacturers), for SMS, MQTT etc
```YAML
#Example Config file configuration
apiKeys :  
  smstgateway : < your api KEY HERE>
securitySystem :
 #device protocol
 deviceManufacturer : GenericDevice 
```
Configuration for custom device integration will allow for more specific configurations to be handled

For specific system configurations like database or security integrations there can a wizard on startup that will ask a specific series questions to guide to properly configuration
Custom routines configurations must follow certain format or YAML structure. The validation of custom routine configurations can prevent errors when it comes into runtime and can improve security

You should consider storing credentials on secure storage like HashSafe for sensitive settings or environment variable to allow for flexibility on deployment
Finally backup and configuration of configurations on version management. This protect from potential loss of information during upgrades

## Project Structure
The repository layout comprises several crucial directory components and source files for managing the entire platform's functionalities:

* `src/`: Houses core project logic (including APIs endpoint and system routines), Python scripts
* `src/api/`: Handles REST APIs (routing, controllers). 
* `src/ui/`: React component implementation
* `configs/`: Configuration YAML/JSON file
* `tests/`: All system testing, automated or integration test suite and checks

We use GitFlow methodology and each component have it corresponding git branching

The main directory holds README.md with general instruction
We also separate log data for monitoring purposes in separate location

The system uses modular components, and all of its parts should run in their containers container (if it uses a container approach to deploy it).
The directory is separated between frontend and backend components. The main `app.py` serves Python logic.

This separation of concern makes easy and quick for developers

## Contributing
Contributions are highly welcome, so help us make a smarter system. Please create Issues so we know your ideas! Follow below steps before sending us contribution

Before making your code push:  ensure you are up to date to master
  create your local working directory, with specific changes

Submit PR (pull requests) after a good unit and automated check

All commits should follow semantic verison standard to allow to track version history. 
Adhere strictly because this will help our automation tools
Use a Python-based lint and coding style standard to maintain project uniformity (using a code linter such as PyLint or equivalent)
All new functionality needs a complete automated and functional tests
All changes and updates require a code- review and signoffs for approval to merge.


## License
This project is licensed under the MIT License, a very permissive License with few requirements, as well as very simple to follow guidelines: you should mention the copyright in all files you create from code and give appropriate copyright mentions in documentation. You also agree the code must be shared with original notice.
Please be also free of distribution and adaptation without the restriction to the code
Please respect this license to make a collaborative development effort for this great projects


## Acknowledgments
SmartHomeManager has leveraged open source platforms as core technology building. We have benefited heavily in development of several libraries for data manipulation, web serving components etc
The system owes credit from React library, and for Python tools, we use PyTest library. For system logging tools for debugging, and many others, that make this possible, thanks. 
Finally we owe great credits and appreciation on developers on open communities, as without the support there the progress is hard.




## System Architecture
SmartHomeManager operates using a tiered system, comprising the user frontend interface , an  API backend with a centralized control system as an underlying layer to provide the system automation functionality, as device control

User requests flow as UI -> APIs endpoints ->  control systems routines (that trigger actions by interacting directly devices) -> device feedback
API backend serves a RESTful APIs and uses a central control system, responsible in orchestrate all routines based in rules

Central Controller module uses the configured configuration data from config data files, or the environmental values and it orchestrates different actions by triggering routines to manage system components or device interactions and configurations to meet the user defined configuration

We utilize modular plugins (device-drivers for external systems integrations like Z wave , Home Assistances or MQTT, ZigBee)
It supports asynchronous messaging queues. The core design is scalable and modular

The overall design is to support modular plugin for easy hardware expansion.




## API Reference

`/ devices `<deviceId > :`

  -GET - Returns information and states of the particular ID device

-PUT: Update status of devices.
Example of an endpoint `/auth/ register : Register account
`{ username }`. The return will return token
The endpoint for routines is
 `api. / routines ` for listing routines
POST: create
DELETE for Delete



## Testing
Run testing to test all features by command. 
We used `pytest` framework, you may install via 

``` bash
pip install pytest
```
To Run tests complete run all: pytest -s.
For more advanced, specify certain tests
  ``` bash
  pytest path to tests folder / specific function.
```
Automated unit test for different scenarios. It runs after installation to confirm it runs smoothly, as an integrated process in CI/CD
Ensure you follow testing standards for code contribution to allow to maintain consistent coverage for future features



## Troubleshooting
Facing errors in the UI? First clear browser's cached. Then double verify the URL, the environment, and all configurations

Issues on device integration, review your API Key and protocol. Check all logs on devices. 
The configuration is corrupted and is not loading. Try reset the account configuration on first-up
The system can be running with incorrect permissions if running from root.

Database error messages usually are caused because the correct JDBC URL are incorrect. Please refer database connection instructions for more information

We're actively improving our logging capabilities so any new errors and logs, please create issues.  It would really assist to diagnose errors


## Performance and Optimization
We implemented the following: Caching system and using the asynchronous routines in background tasks
For high load situations use distributed database clusters to avoid single server bottlenecks and increase availability 
To optimize hardware integration ensure devices are connected and are working at the proper network configurations
Use efficient algorithm (reduce memory allocation).  We have implemented profiling tools (Python cProfile to track code runtime for performance benchmark and optimize performance bottlenecks. We also suggest monitoring memory leaks

Consider optimizing data structure, as a general performance guideline
Optimize routines configurations and rules by limiting calls or reducing loops and checks




## Security Considerations
Store credentials (such as SMS, or other third parties, APIs) using environment secrets or key vaults, not in config or in files 
Always implement data and input validation for malicious requests
Use authentication to ensure access controls for users 
Enable logging, and audit events in secure location, not publicly visible (for forensic or incident events to review) 
Use latest software versions (both the system as all dependencies, and regularly scan dependencies using vulnerability scanner

## Roadmap
Upcoming goals of our system
Implement AI features to predict usage and adjust system accordingly, such as predictive climate. We aim this on release 3.0, and are in the research process right now to determine optimal models
Adding integration with third parties suchs security providers like Google Security and other security subscriptions 

Develop advanced routines, such like automated energy consumption reduction or custom routines to automate responses in security alerts based user configuration

Expand to additional platform to make our product work more widely (such:  Google Assistant/ Smart Home, Smart Thing and Apple) and more hardware device providers



## FAQ (Frequently Asked Questions)
I see "Failed To Connect Database." Ensure database running or database connection strings are wrong 
UI fails and show empty content or loading page - clear all cookies from browser

Why can i set the system into production and use as a standalone appliance: The security is very limited currently (authentication), it will take effort
I get SMS error message.  It's a configuration issues and/ API credentials. Review it again, it will probably fixed

Can the configuration change while I deploy: yes , but ensure proper version of configs and database
Is possible for third party integration for new security systems : absolutely possible

## Citation
To properly acknowledge this effort, use following information
SmartHomeManager v2.0 - 2024 - Open source Residential automati
  @conference{SmartHomeManager2024,
    author = {Developer Team Name},
    title = {SmartHomeManager -Automated Residential System Contral version 2.0},
    year = {2024},
    url = {https://github.com/your-username/smart-home-manager}
  }


## Contact
Reach our developers and contributors for issues by creating Github issues

Reach us through: [email protected] and we welcome your suggestions
We use the following channel
For quick help and assistance reach through Discord.
[link] to discord channel or slack channel



